"use strict";(self.webpackChunkurl_storage=self.webpackChunkurl_storage||[]).push([[229],{6229:function(e,r,s){s.r(r),s.d(r,{default:function(){return w}});var t=s(5861),a=s(4942),n=s(1413),c=s(885),i=s(7757),d=s.n(i),u=s(7313),l=s(6352),o=s(9466),p=s(5803),h=s(3664),f=s(8952),x=function(){var e=(0,t.Z)(d().mark((function e(r){var s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.bl.get("/user/all_infor",{headers:{Authorization:r}});case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),m=s(9127),j=(s(8964),s(820)),v=s(6417),Z={user_id:"",password:"",cf_password:"",err:"",success:""};var w=function(){var e=(0,l.v9)((function(e){return e.auth})),r=(0,l.v9)((function(e){return e.token})),s=(0,l.v9)((function(e){return e.users})),i=e.user,w=e.isAdmin,b=(0,u.useState)(Z),g=(0,c.Z)(b,2),_=g[0],y=g[1],k=(0,u.useState)(!1),N=(0,c.Z)(k,2),S=N[0],z=N[1],C=(0,u.useState)(!1),U=(0,c.Z)(C,2),A=U[0],E=U[1],F=(0,u.useState)(!1),D=(0,c.Z)(F,2),L=D[0],P=D[1],R=_.user_id,G=_.password,B=_.cf_password,I=_.err,M=_.success,T=(0,l.I0)();(0,u.useEffect)((function(){w&&x(r).then((function(e){T(function(e){return{type:h.Z.GET_ALL_USERS,payload:e.data}}(e))}))}),[r,w,T,L]);var V=function(e){var r,s=e.target,t=s.name,c=s.value;y((0,n.Z)((0,n.Z)({},_),{},(r={},(0,a.Z)(r,t,c),(0,a.Z)(r,"err",""),(0,a.Z)(r,"success",""),r)))},X=function(){try{f.bl.patch("/user/update",{user_id:R||i.user_id,avatar:S||i.avatar},{headers:{Authorization:r}}),y((0,n.Z)((0,n.Z)({},_),{},{err:"",success:"Updated Success!"}))}catch(I){y((0,n.Z)((0,n.Z)({},_),{},{err:I.response.data.msg,success:""}))}},Y=function(){if((0,p.G9)(G))return y((0,n.Z)((0,n.Z)({},_),{},{err:"Password must be at least 6 characters.",success:""}));if(!(0,p.BD)(G,B))return y((0,n.Z)((0,n.Z)({},_),{},{err:"Password did not match.",success:""}));try{f.bl.post("/user/reset",{password:G},{headers:{Authorization:r}}),y((0,n.Z)((0,n.Z)({},_),{},{err:"",success:"Updated Success!"}))}catch(I){y((0,n.Z)((0,n.Z)({},_),{},{err:I.response.data.msg,success:""}))}},K=function(){var e=(0,t.Z)(d().mark((function e(s){var t,a,c;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),e.prev=1,t=s.target.files[0]){e.next=5;break}return e.abrupt("return",y((0,n.Z)((0,n.Z)({},_),{},{err:"No files were uploaded.",success:""})));case 5:if(!(t.size>1048576)){e.next=7;break}return e.abrupt("return",y((0,n.Z)((0,n.Z)({},_),{},{err:"Size too large.",success:""})));case 7:if("image/jpeg"===t.type||"image/png"===t.type||"image/jpg"===t.type){e.next=9;break}return e.abrupt("return",y((0,n.Z)((0,n.Z)({},_),{},{err:"File format is incorrect.",success:""})));case 9:return(a=new FormData).append("file",t),E(!0),e.next=14,f.bl.post("/apitest/upload_avatar",a,{headers:{"content-type":"multipart/form-data",Authorization:r}});case 14:c=e.sent,E(!1),z(c.data.url),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(1),y((0,n.Z)((0,n.Z)({},_),{},{err:e.t0.response.data.msg,success:""}));case 22:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(r){return e.apply(this,arguments)}}(),O=function(){var e=(0,t.Z)(d().mark((function e(s){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i._id===s){e.next=8;break}if(!window.confirm("\uc815\ub9d0 \uc774 \uacc4\uc815\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){e.next=8;break}return E(!0),e.next=6,f.bl.delete("/user/delete/".concat(s),{headers:{Authorization:r}});case 6:E(!1),P(!L);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),y((0,n.Z)((0,n.Z)({},_),{},{err:e.t0.response.data.msg,success:""}));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(r){return e.apply(this,arguments)}}();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{children:[I&&(0,m.X)(I),M&&(0,m.C)(M),A&&(0,v.jsx)("h3",{children:"Loading....."})]}),(0,v.jsxs)("div",{className:"profile_page",children:[(0,v.jsxs)("div",{className:"col-left",children:[(0,v.jsx)("h2",{children:w?"\uad00\ub9ac\uc790 \ud504\ub85c\ud544":"\uc720\uc800 \ud504\ub85c\ud544"}),(0,v.jsxs)("div",{className:"avatar",children:[(0,v.jsx)("img",{src:S||i.avatar,alt:""}),(0,v.jsxs)("span",{children:[(0,v.jsxs)("p",{children:[(0,v.jsx)(j.Ey1,{size:"30"})," ",(0,v.jsx)("br",{}),"\ud504\ub85c\ud544\uc0ac\uc9c4\ubcc0\uacbd"]}),(0,v.jsx)("input",{type:"file",name:"file",id:"file_up",onChange:K})]})]}),(0,v.jsxs)("div",{className:"form-group",children:[(0,v.jsx)("label",{htmlFor:"user_id",children:"Userid"}),(0,v.jsx)("input",{type:"text",name:"user_id",id:"user_id",placeholder:"\ub2f9\uc2e0\uc758 \uc544\uc774\ub514",defaultValue:i.user_id})]}),(0,v.jsxs)("div",{className:"form-group",children:[(0,v.jsx)("label",{htmlFor:"email",children:"Email"}),(0,v.jsx)("input",{type:"email",name:"email",id:"email",defaultValue:i.email,placeholder:"Your email address",disabled:!0})]}),(0,v.jsxs)("div",{className:"form-group",children:[(0,v.jsx)("label",{htmlFor:"password",children:"New Password"}),(0,v.jsx)("input",{type:"password",name:"password",id:"password",placeholder:"Your password",value:G,onChange:V})]}),(0,v.jsxs)("div",{className:"form-group",children:[(0,v.jsx)("label",{htmlFor:"cf_password",children:"Confirm New Password"}),(0,v.jsx)("input",{type:"password",name:"cf_password",id:"cf_password",placeholder:"Confirm password",value:B,onChange:V})]}),(0,v.jsx)("div",{children:(0,v.jsx)("em",{style:{color:"red"},children:"* \uad6c\uae00\uc544\uc774\ub514\ub85c \ub85c\uadf8\uc778\ud55c \uacbd\uc6b0 \ube44\ubc00\ubc88\ud638 \ubcc0\uacbd\uc5d0 \uc720\uc758\ud574\uc8fc\uc138\uc694!"})}),(0,v.jsx)("button",{disabled:A,onClick:function(){(R||S)&&X(),G&&Y()},children:"Update"})]}),w?(0,v.jsxs)("div",{className:"col-right",children:[(0,v.jsx)("h2",{children:w?"Users":"MyOrders"}),(0,v.jsx)("div",{style:{overFlowX:"auto"},children:(0,v.jsxs)("table",{className:"customers",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"USERNUM"}),(0,v.jsx)("th",{children:"USERID"}),(0,v.jsx)("th",{children:"Email"}),(0,v.jsx)("th",{children:"Admin"}),(0,v.jsx)("th",{children:"Action"})]})}),(0,v.jsx)("tbody",{children:s.map((function(e){return(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:e._id}),(0,v.jsx)("td",{children:e.user_id}),(0,v.jsx)("td",{children:e.email}),(0,v.jsx)("td",{children:1===e.role?(0,v.jsx)(j.Lrl,{color:"green"}):(0,v.jsx)(j.S1K,{color:"red"})}),(0,v.jsxs)("td",{children:[(0,v.jsx)(o.rU,{to:"/edit_user/".concat(e._id),children:(0,v.jsx)(j.$jT,{color:"black",size:"20"})}),(0,v.jsx)(j.R6G,{className:"deleteBtn",cursor:"pointer",size:"20",onClick:function(){return O(e._id)}})]})]},e._id)}))})]})})]}):null]})]})}},8964:function(){}}]);